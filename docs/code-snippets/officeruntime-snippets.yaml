OfficeRuntime.Auth:interface:
  - |-
    // Get the auth context object and use it to get an
    // access token.
    const authContext = OfficeRuntime.context.auth;
    const accessToken = authContext.getAccessTokenAsync();
OfficeRuntime.Auth#getAccessToken:member(1):
  - |-
    async function getUserData() {
      try {
          let userTokenEncoded = await OfficeRuntime.auth.getAccessToken();
          let userToken = jwt_decode(userTokenEncoded); // Using the https://www.npmjs.com/package/jwt-decode library.
          console.log(userToken.name); // user name
          console.log(userToken.preferred_username); // email
          console.log(userToken.oid); // user id     
      }
      catch (exception) {
          if (exception.code === 13003) {
              // SSO is not supported for domain user accounts, only
              // Microsoft 365 Education or work account, or a Microsoft account.
          } else {
              // Handle error
          }
      }
    }
OfficeRuntime.displayWebDialog:function(1):
  - |-
    /**
     * Opens an authentication dialog from a custom function.
     * @customfunction AUTH.LOGIN
     * @returns A promise that resolves to the authentication result.
     */
    async function login(): Promise<string> {
      const dialogUrl = "https://your-addin-domain.com/auth-dialog.html";

      return new Promise((resolve, reject) => {
        OfficeRuntime.displayWebDialog(dialogUrl, {
          height: "50%",
          width: "40%",

          onMessage: (message: string, dialog?: OfficeRuntime.Dialog) => {
            // Handle messages sent from the dialog via window.opener.postMessage().
            const data = JSON.parse(message);

            if (data.type === "auth-success") {
              // Process the authentication token
              dialog?.close();
              resolve(`Signed in as ${data.username}`);
            } else if (data.type === "auth-error") {
              dialog?.close();
              reject(new Error(data.errorMessage));
            }
          },

          onClose: () => {
            // Handle the user closing the dialog.
            resolve("Dialog closed");
          },

          onRuntimeError: (error: Error, dialog?: OfficeRuntime.Dialog) => {
            // Handle runtime errors from the dialog.
            dialog?.close();
            reject(error);
          },
        }).catch((error) => {
          reject(new Error(`Failed to open dialog: ${error.message}`));
        });
      });
    }