### YamlMime:TSType
name: Office.Body
uid: 'outlook!Office.Body:interface'
package: outlook!
fullName: Office.Body
summary: >-
  The body object provides methods for adding and updating the content of the
  message or appointment. It is returned in the body property of the selected
  item.


  \[ [API set: Mailbox
  1.1](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)
  \]
remarks: >-
  **[Minimum permission
  level](https://docs.microsoft.com/office/dev/add-ins/outlook/understanding-outlook-add-in-permissions)<!--
  -->**: `ReadItem`


  **[Applicable Outlook
  mode](https://docs.microsoft.com/office/dev/add-ins/outlook/outlook-add-ins-overview#extension-points)<!--
  -->**: Compose or Read
isPreview: false
isDeprecated: false
type: interface
methods:
  - name: 'appendOnSendAsync(data, options, callback)'
    uid: 'outlook!Office.Body#appendOnSendAsync:member(1)'
    package: outlook!
    fullName: 'appendOnSendAsync(data, options, callback)'
    summary: >-
      Appends on send the specified content to the end of the item body, after
      any signature.


      If the user is running add-ins that implement the [on-send feature using
      \`ItemSend\` in the
      manifest](https://docs.microsoft.com/office/dev/add-ins/outlook/outlook-on-send-addins?tabs=windows)<!--
      -->, append-on-send runs before on-send functionality.


      **Important**: If your add-in implements the on-send feature and calls
      `appendOnSendAsync` in the `ItemSend` handler, the `appendOnSendAsync`
      call returns an error as this scenario is not supported.


      **Important**: To use `appendOnSendAsync`<!-- -->, the
      `ExtendedPermissions` manifest node must include the `AppendOnSend`
      extended permission.


      **Note**: To clear data from a previous `appendOnSendAsync` call, you can
      call it again with the `data` parameter set to `null`<!-- -->.


      \[ [API set: Mailbox
      1.9](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)
      \]
    remarks: >-
      **[Minimum permission
      level](https://docs.microsoft.com/office/dev/add-ins/outlook/understanding-outlook-add-in-permissions)<!--
      -->**: `ReadWriteItem`


      **[Applicable Outlook
      mode](https://docs.microsoft.com/office/dev/add-ins/outlook/outlook-add-ins-overview#extension-points)<!--
      -->**: Compose


      **Errors**:


      - `DataExceedsMaximumSize`<!-- -->: The `data` parameter is longer than
      5,000 characters.


      - `InvalidFormatError`<!-- -->: The `options.coercionType` parameter is
      set to `Office.CoercionType.Html` but the message body is in plain text.


      #### Examples


      ```javascript

      Office.context.mailbox.item.body.appendOnSendAsync(
          "P.S. This text was appended on send.",
          {coercionType: Office.CoercionType.Html},
          function (asyncResult) {
              if (asyncResult.status === Office.AsyncResultStatus.Failed) {
                  console.log("Action failed with error: " + asyncResult.error.message);
              }
          }
      );

      ```
    isPreview: false
    isDeprecated: false
    syntax:
      content: >-
        appendOnSendAsync(data: string, options?: Office.AsyncContextOptions &
        CoercionTypeOptions, callback?: (asyncResult: Office.AsyncResult<void>)
        => void): void;
      parameters:
        - id: data
          description: >-
            The string to be added to the end of the body. The string is limited
            to 5,000 characters.
          type: string
        - id: options
          description: >-
            Optional. An object literal that contains one or more of the
            following properties. `asyncContext`<!-- -->: Developers can provide
            any object they wish to access in the callback method.
            `coercionType`<!-- -->: The desired format for the data to be
            appended. The string in the `data` parameter will be converted to
            this format.
          type: >-
            <xref uid="office!Office.AsyncContextOptions:interface" /> & <xref
            uid="outlook!Office.CoercionTypeOptions:interface" />
        - id: callback
          description: >-
            Optional. When the method completes, the function passed in the
            `callback` parameter is called with a single parameter of type
            `Office.AsyncResult`<!-- -->. Any errors encountered will be
            provided in the `asyncResult.error` property.
          type: >-
            (asyncResult: <xref uid="office!Office.AsyncResult:interface"
            />&lt;void&gt;) =&gt; void
      return:
        type: void
        description: ''
  - name: 'getAsync(coercionType, options, callback)'
    uid: 'outlook!Office.Body#getAsync:member(1)'
    package: outlook!
    fullName: 'getAsync(coercionType, options, callback)'
    summary: >-
      Returns the current body in a specified format.


      This method returns the entire current body in the format specified by
      `coercionType`<!-- -->.


      When working with HTML-formatted bodies, it is important to note that the
      `Body.getAsync` and `Body.setAsync` methods are not idempotent. The value
      returned from the `getAsync` method will not necessarily be exactly the
      same as the value that was passed in the `setAsync` method previously. The
      client may modify the value passed to `setAsync` in order to make it
      render efficiently with its rendering engine.


      \[ [API set: Mailbox
      1.3](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)
      \]
    remarks: >-
      **[Minimum permission
      level](https://docs.microsoft.com/office/dev/add-ins/outlook/understanding-outlook-add-in-permissions)<!--
      -->**: `ReadItem`


      **[Applicable Outlook
      mode](https://docs.microsoft.com/office/dev/add-ins/outlook/outlook-add-ins-overview#extension-points)<!--
      -->**: Compose or Read


      #### Examples


      ```javascript

      // This example gets the body of the item as plain text.

      Office.context.mailbox.item.body.getAsync(
          "text",
          { asyncContext: "This is passed to the callback" },
          function callback(result) {
              // Do something with the result.
          });

      // The following is an example of the result parameter passed to the
      callback function.

      {
          "value": "TEXT of whole body (including threads below)",
          "status": "succeeded",
          "asyncContext": "This is passed to the callback"
      }

      ```
    isPreview: false
    isDeprecated: false
    syntax:
      content: >-
        getAsync(coercionType: Office.CoercionType | string, options?:
        Office.AsyncContextOptions, callback?: (asyncResult:
        Office.AsyncResult<string>) => void): void;
      parameters:
        - id: coercionType
          description: The format for the returned body.
          type: '<xref uid="office!Office.CoercionType:enum" /> | string'
        - id: options
          description: >-
            Optional. An object literal that contains one or more of the
            following properties: `asyncContext`<!-- -->: Developers can provide
            any object they wish to access in the callback method.
          type: '<xref uid="office!Office.AsyncContextOptions:interface" />'
        - id: callback
          description: >-
            Optional. When the method completes, the function passed in the
            `callback` parameter is called with a single parameter of type
            Office.AsyncResult. The body is provided in the requested format in
            the `asyncResult.value` property.
          type: >-
            (asyncResult: <xref uid="office!Office.AsyncResult:interface"
            />&lt;string&gt;) =&gt; void
      return:
        type: void
        description: ''
  - name: 'getTypeAsync(options, callback)'
    uid: 'outlook!Office.Body#getTypeAsync:member(1)'
    package: outlook!
    fullName: 'getTypeAsync(options, callback)'
    summary: >-
      Gets a value that indicates whether the content is in HTML or text format.


      \[ [API set: Mailbox
      1.1](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)
      \]
    remarks: >-
      **[Minimum permission
      level](https://docs.microsoft.com/office/dev/add-ins/outlook/understanding-outlook-add-in-permissions)<!--
      -->**: `ReadItem`


      **[Applicable Outlook
      mode](https://docs.microsoft.com/office/dev/add-ins/outlook/outlook-add-ins-overview#extension-points)<!--
      -->**: Compose


      #### Examples


      ```javascript

      Office.context.mailbox.item.body.getTypeAsync(function (asyncResult) {
          if (asyncResult.status === "failed") {
              console.log("Action failed with error: " + asyncResult.error.message);
          } else {
              console.log("Body type: " + asyncResult.value);
          }
      });

      ```
    isPreview: false
    isDeprecated: false
    syntax:
      content: >-
        getTypeAsync(options?: Office.AsyncContextOptions, callback?:
        (asyncResult: Office.AsyncResult<Office.CoercionType>) => void): void;
      parameters:
        - id: options
          description: >-
            Optional. An object literal that contains one or more of the
            following properties. `asyncContext`<!-- -->: Developers can provide
            any object they wish to access in the callback method.
          type: '<xref uid="office!Office.AsyncContextOptions:interface" />'
        - id: callback
          description: >-
            Optional. When the method completes, the function passed in the
            `callback` parameter is called with a single parameter of type
            `Office.AsyncResult`<!-- -->. The content type is returned as one of
            the `CoercionType` values in the `asyncResult.value` property.
          type: >-
            (asyncResult: <xref uid="office!Office.AsyncResult:interface"
            />&lt;<xref uid="office!Office.CoercionType:enum" />&gt;) =&gt; void
      return:
        type: void
        description: ''
  - name: 'prependAsync(data, options, callback)'
    uid: 'outlook!Office.Body#prependAsync:member(1)'
    package: outlook!
    fullName: 'prependAsync(data, options, callback)'
    summary: >-
      Adds the specified content to the beginning of the item body.


      The `prependAsync` method inserts the specified string at the beginning of
      the item body. After insertion, the cursor is returned to its original
      place, relative to the inserted content.


      When working with HTML-formatted bodies, it's important to note that the
      client may modify the value passed to `prependAsync` in order to make it
      render efficiently with its rendering engine. This means that the value
      returned from a subsequent call to `Body.getAsync` method will not
      necessarily exactly contain the value that was passed in the
      `prependAsync` method previously.


      When including links in HTML markup, you can disable online link preview
      by setting the `id` attribute on the anchor (<!-- -->&lt;<!-- -->a<!--
      -->&gt;<!-- -->) to "LPNoLP" (see the **Examples** section for a sample).


      \[ [API set: Mailbox
      1.1](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)
      \]
    remarks: >-
      **[Minimum permission
      level](https://docs.microsoft.com/office/dev/add-ins/outlook/understanding-outlook-add-in-permissions)<!--
      -->**: `ReadWriteItem`


      **[Applicable Outlook
      mode](https://docs.microsoft.com/office/dev/add-ins/outlook/outlook-add-ins-overview#extension-points)<!--
      -->**: Compose


      **Errors**:


      - `DataExceedsMaximumSize`<!-- -->: The data parameter is longer than
      1,000,000 characters.


      #### Examples


      ```javascript

      // When including links in HTML markup, you can disable online link
      preview

      // by setting the id attribute on the anchor (<a>) to "LPNoLP".

      Office.context.mailbox.item.body.prependAsync(
          '<a id="LPNoLP" href="http://www.contoso.com">Click here!</a>',
          {coercionType: Office.CoercionType.Html},
          callback);
      ```
    isPreview: false
    isDeprecated: false
    syntax:
      content: >-
        prependAsync(data: string, options?: Office.AsyncContextOptions &
        CoercionTypeOptions, callback?: (asyncResult: Office.AsyncResult<void>)
        => void): void;
      parameters:
        - id: data
          description: >-
            The string to be inserted at the beginning of the body. The string
            is limited to 1,000,000 characters.
          type: string
        - id: options
          description: >-
            Optional. An object literal that contains one or more of the
            following properties. `asyncContext`<!-- -->: Developers can provide
            any object they wish to access in the callback method.
            `coercionType`<!-- -->: The desired format for the body. The string
            in the `data` parameter will be converted to this format.
          type: >-
            <xref uid="office!Office.AsyncContextOptions:interface" /> & <xref
            uid="outlook!Office.CoercionTypeOptions:interface" />
        - id: callback
          description: >-
            Optional. When the method completes, the function passed in the
            `callback` parameter is called with a single parameter of type
            `Office.AsyncResult`<!-- -->. Any errors encountered will be
            provided in the `asyncResult.error` property.
          type: >-
            (asyncResult: <xref uid="office!Office.AsyncResult:interface"
            />&lt;void&gt;) =&gt; void
      return:
        type: void
        description: ''
  - name: 'setAsync(data, options, callback)'
    uid: 'outlook!Office.Body#setAsync:member(1)'
    package: outlook!
    fullName: 'setAsync(data, options, callback)'
    summary: >-
      Replaces the entire body with the specified text.


      When working with HTML-formatted bodies, it is important to note that the
      `Body.getAsync` and `Body.setAsync` methods are not idempotent. The value
      returned from the `getAsync` method will not necessarily be exactly the
      same as the value that was passed in the `setAsync` method previously. The
      client may modify the value passed to `setAsync` in order to make it
      render efficiently with its rendering engine.


      When including links in HTML markup, you can disable online link preview
      by setting the `id` attribute on the anchor (<!-- -->&lt;<!-- -->a<!--
      -->&gt;<!-- -->) to "LPNoLP" (see the **Examples** section for a sample).


      \[ [API set: Mailbox
      1.3](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)
      \]
    remarks: >-
      **[Minimum permission
      level](https://docs.microsoft.com/office/dev/add-ins/outlook/understanding-outlook-add-in-permissions)<!--
      -->**: `ReadWriteItem`


      **[Applicable Outlook
      mode](https://docs.microsoft.com/office/dev/add-ins/outlook/outlook-add-ins-overview#extension-points)<!--
      -->**: Compose


      **Errors**:


      - `DataExceedsMaximumSize`<!-- -->: The data parameter is longer than
      1,000,000 characters.


      - `InvalidFormatError`<!-- -->: The `options.coercionType` parameter is
      set to `Office.CoercionType.Html` and the message body is in plain text.


      #### Examples


      ```javascript

      // When including links in HTML markup, you can disable online link
      preview

      // by setting the id attribute on the anchor (<a>) to "LPNoLP".

      Office.context.mailbox.item.body.setAsync(
          '<a id="LPNoLP" href="http://www.contoso.com">Click here!</a>',
          {coercionType: Office.CoercionType.Html},
          callback);
      Office.context.mailbox.item.body.setAsync(
          "<b>(replaces all body, including threads you are replying to that may be on the bottom)</b>",
          { coercionType: "html", asyncContext: "This is passed to the callback" },
          function callback(result) {
              // Process the result.
      });


      // The following is an example of the result parameter passed to the
      callback function.

      {
          "value":null,
          "status": "succeeded",
          "asyncContext": "This is passed to the callback"
      }

      ```
    isPreview: false
    isDeprecated: false
    syntax:
      content: >-
        setAsync(data: string, options?: Office.AsyncContextOptions &
        CoercionTypeOptions, callback?: (asyncResult: Office.AsyncResult<void>)
        => void): void;
      parameters:
        - id: data
          description: >-
            The string that will replace the existing body. The string is
            limited to 1,000,000 characters.
          type: string
        - id: options
          description: >-
            Optional. An object literal that contains one or more of the
            following properties. `asyncContext`<!-- -->: Developers can provide
            any object they wish to access in the callback method.
            `coercionType`<!-- -->: The desired format for the body. The string
            in the `data` parameter will be converted to this format.
          type: >-
            <xref uid="office!Office.AsyncContextOptions:interface" /> & <xref
            uid="outlook!Office.CoercionTypeOptions:interface" />
        - id: callback
          description: >-
            Optional. When the method completes, the function passed in the
            `callback` parameter is called with a single parameter of type
            Office.AsyncResult. Any errors encountered will be provided in the
            `asyncResult.error` property.
          type: >-
            (asyncResult: <xref uid="office!Office.AsyncResult:interface"
            />&lt;void&gt;) =&gt; void
      return:
        type: void
        description: ''
  - name: 'setSelectedDataAsync(data, options, callback)'
    uid: 'outlook!Office.Body#setSelectedDataAsync:member(1)'
    package: outlook!
    fullName: 'setSelectedDataAsync(data, options, callback)'
    summary: >-
      Replaces the selection in the body with the specified text.


      The `setSelectedDataAsync` method inserts the specified string at the
      cursor location in the body of the item, or, if text is selected in the
      editor, it replaces the selected text. If the cursor was never in the body
      of the item, or if the body of the item lost focus in the UI, the string
      will be inserted at the top of the body content. After insertion, the
      cursor is placed at the end of the inserted content.


      When including links in HTML markup, you can disable online link preview
      by setting the id attribute on the anchor (<!-- -->&lt;<!-- -->a<!--
      -->&gt;<!-- -->) to "LPNoLP" (see the **Examples** section for a sample).


      \[ [API set: Mailbox
      1.1](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)
      \]
    remarks: >-
      **[Minimum permission
      level](https://docs.microsoft.com/office/dev/add-ins/outlook/understanding-outlook-add-in-permissions)<!--
      -->**: `ReadWriteItem`


      **[Applicable Outlook
      mode](https://docs.microsoft.com/office/dev/add-ins/outlook/outlook-add-ins-overview#extension-points)<!--
      -->**: Compose


      **Errors**:


      - `DataExceedsMaximumSize`<!-- -->: The `data` parameter is longer than
      1,000,000 characters.


      - `InvalidFormatError`<!-- -->: The `options.coercionType` parameter is
      set to `Office.CoercionType.Html` and the message body is in plain text.


      #### Examples


      ```javascript

      // When including links in HTML markup, you can disable online link
      preview

      // by setting the id attribute on the anchor (<a>) to "LPNoLP".

      Office.context.mailbox.item.body.setSelectedDataAsync(
          '<a id="LPNoLP" href="http://www.contoso.com">Click here!</a>',
          {coercionType: Office.CoercionType.Html},
          callback);
      ```
    isPreview: false
    isDeprecated: false
    syntax:
      content: >-
        setSelectedDataAsync(data: string, options?: Office.AsyncContextOptions
        & CoercionTypeOptions, callback?: (asyncResult:
        Office.AsyncResult<void>) => void): void;
      parameters:
        - id: data
          description: >-
            The string that will replace the existing body. The string is
            limited to 1,000,000 characters.
          type: string
        - id: options
          description: >-
            Optional. An object literal that contains one or more of the
            following properties. `asyncContext`<!-- -->: Developers can provide
            any object they wish to access in the callback method.
            `coercionType`<!-- -->: The desired format for the body. The string
            in the `data` parameter will be converted to this format.
          type: >-
            <xref uid="office!Office.AsyncContextOptions:interface" /> & <xref
            uid="outlook!Office.CoercionTypeOptions:interface" />
        - id: callback
          description: >-
            Optional. When the method completes, the function passed in the
            `callback` parameter is called with a single parameter of type
            `Office.AsyncResult`<!-- -->. Any errors encountered will be
            provided in the `asyncResult.error` property.
          type: >-
            (asyncResult: <xref uid="office!Office.AsyncResult:interface"
            />&lt;void&gt;) =&gt; void
      return:
        type: void
        description: ''
  - name: 'setSignatureAsync(data, options, callback)'
    uid: 'outlook!Office.Body#setSignatureAsync:member(1)'
    package: outlook!
    fullName: 'setSignatureAsync(data, options, callback)'
    summary: >-
      Adds or replaces the signature of the item body.


      **Important**: In Outlook on the web, `setSignatureAsync` only works on
      messages.


      **Important**: If your add-in implements the [event-based activation
      feature using \`LaunchEvent\` in the
      manifest](https://docs.microsoft.com/office/dev/add-ins/outlook/autolaunch)<!--
      -->, and calls `setSignatureAsync` in the event handler, the following
      behavior applies.


      - When the user composes a new item (including reply or forward), the
      signature is set but doesn't modify the form. This means if the user
      closes the form without making other edits, they won't be prompted to save
      changes.


      \[ [API set: Mailbox
      Preview](/office/dev/add-ins/reference/requirement-sets/outlook-api-requirement-sets)
      \]
    remarks: >-
      **[Minimum permission
      level](https://docs.microsoft.com/office/dev/add-ins/outlook/understanding-outlook-add-in-permissions)<!--
      -->**: `ReadWriteItem`


      **[Applicable Outlook
      mode](https://docs.microsoft.com/office/dev/add-ins/outlook/outlook-add-ins-overview#extension-points)<!--
      -->**: Compose


      **Errors**:


      - `DataExceedsMaximumSize`<!-- -->: The `data` parameter is longer than
      30,000 characters.


      - `InvalidFormatError`<!-- -->: The `options.coercionType` parameter is
      set to `Office.CoercionType.Html` and the message body is in plain text.


      #### Examples


      ```javascript

      // Link to full sample:
      https://raw.githubusercontent.com/OfficeDev/office-js-snippets/master/samples/outlook/99-preview-apis/work-with-client-signatures.yaml

      // Set the signature for the current item with inline image.

      var modIcon1Base64 =
      "iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpDRDMxMDg1MjBCNDZFMTExODE2MkM1RUI2M0M4MDYxRCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpFMTUxQjgyRjQ2MEQxMUUxODlFMkQwNTYzQ0YwMTUxMiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpFMTUxQjgyRTQ2MEQxMUUxODlFMkQwNTYzQ0YwMTUxMiIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1LjEgV2luZG93cyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkQxMzEwODUyMEI0NkUxMTE4MTYyQzVFQjYzQzgwNjFEIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkNEMzEwODUyMEI0NkUxMTE4MTYyQzVFQjYzQzgwNjFEIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+uC/WfAAAAehJREFUeNpilCzfwEAEkAbiECA2A2J1IOaHin8E4ptAfBaIVwLxU0IGMRKw0B6IW4DYhoE4cASIK6E0VsCEQ1wUiNcB8QESLGOAqj0MxBuhZhBloS4QnwHiQAbygR/UDF1CFupCXSjHQDmQg5qli8tCUBBsQUoQ1AD8UDNFsVk4n0o+w+bT+egWglKjNymmeGhLkqLcG2oHAwtUoIuQDj5OVgZPLUmwRe5aEmAxqYqNpFgKssOcCeplM0KqdST5GfpDDRm0JfkYrj3/SE7QguyQY4ImYYLgCtAS10kHGMw6dzNsv/qC7OwCClJXYlR++v6b4er3j5QmIFcmaNlIL6AOslCIjhYKMTHQGTBBqxh6gXcgC6/R0cKbIAv30dHCfaAKGJTxHxJSqS3Fz9DkowNmywpyMcgA8fF7b8D8VWcfM6w8+4gYC+VB+RCk8hSh0gaUD4/dewvlvUWRe/z+GzGWgex4BGtiOAHxXhoHpzMoSGHZAhSPW2lo2VZYWkHOh4nEtLrIAE+hZmNUwK+B2BOIv1PRsu9QM1/jatNcBtVZ0IREKXgENesyoVYbzNIdFFi2A5tl+NqlL6BB4QBNzsSCU1A9nlAzMAALAQMOQl0qB23qWwKxIlIrDBQ394H4OBCvISYqAAIMACVibHDqsO7zAAAAAElFTkSuQmCC";

      Office.context.mailbox.item.addFileAttachmentFromBase64Async(
        modIcon1Base64,
        "myImage.png",
        { isInline: true },
        function(result) {
          if (result.status == Office.AsyncResultStatus.Succeeded) {
            var signature = $("#signature").val() + "<img src='cid:myImage.png'>";
            console.log(`Setting signature to "${signature}".`);
            // Important: setSignatureAsync is currently in preview.
            Office.context.mailbox.item.body.setSignatureAsync(
              signature,
              { coercionType: "html" },
              function(asyncResult) {
                console.log(`setSignatureAsync: ${asyncResult.status}`);
              }
            );
          } else {
            console.error(`addFileAttachmentFromBase64Async: ${result.error}`);
          }
        }
      );

      ```

      ```javascript

      // Link to full sample:
      https://raw.githubusercontent.com/OfficeDev/office-js-snippets/master/samples/outlook/99-preview-apis/work-with-client-signatures.yaml

      // Set the signature for the current item.

      var signature = $("#signature").val();

      console.log(`Setting signature to "${signature}".`);

      Office.context.mailbox.item.body.setSignatureAsync(signature,
      function(asyncResult) {
        if (asyncResult.status === Office.AsyncResultStatus.Succeeded) {
          console.log("setSignatureAsync succeeded");
        } else {
          console.error(asyncResult.error);
        }
      });

      ```
    isPreview: true
    isDeprecated: false
    syntax:
      content: >-
        setSignatureAsync(data: string, options?: Office.AsyncContextOptions &
        CoercionTypeOptions, callback?: (asyncResult: Office.AsyncResult<void>)
        => void): void;
      parameters:
        - id: data
          description: >-
            The string that represents the signature to be set in the body of
            the mail. This string is limited to 30,000 characters.
          type: string
        - id: options
          description: >-
            Optional. An object literal that contains one or more of the
            following properties. `asyncContext`<!-- -->: Developers can provide
            any object they wish to access in the callback method.
            `coercionType`<!-- -->: The format the signature should be set to.
            If Text, the method sets the signature to plain text, removing any
            HTML tags present. If Html, the method sets the signature to HTML.
          type: >-
            <xref uid="office!Office.AsyncContextOptions:interface" /> & <xref
            uid="outlook!Office.CoercionTypeOptions:interface" />
        - id: callback
          description: >-
            Optional. When the method completes, the function passed in the
            `callback` parameter is called with a single parameter of type
            `Office.AsyncResult`<!-- -->.
          type: >-
            (asyncResult: <xref uid="office!Office.AsyncResult:interface"
            />&lt;void&gt;) =&gt; void
      return:
        type: void
        description: ''
