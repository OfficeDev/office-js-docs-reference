### YamlMime:TSPackage
uid: office-runtime!
name: office-runtime
type: package
summary: ''
interfaces:
  - office-runtime!OfficeRuntime.ApiInformation:interface
  - office-runtime!OfficeRuntime.Auth:interface
  - office-runtime!OfficeRuntime.AuthOptions:interface
  - office-runtime!OfficeRuntime.Dialog:interface
  - office-runtime!OfficeRuntime.DisplayWebDialogOptions:interface
  - office-runtime!OfficeRuntime.Storage:interface
functions:
  - name: OfficeRuntime.displayWebDialog(url, options)
    uid: office-runtime!OfficeRuntime.displayWebDialog:function(1)
    package: office-runtime!
    summary: Function that enables a pop up web dialog box.
    remarks: |-
      \[ [API set: CustomFunctionsRuntime 1.1](/office/dev/add-ins/reference/javascript-api-for-office) \]

      #### Examples

      ```TypeScript
      /**
       * Opens an authentication dialog from a custom function.
       * @customfunction AUTH.LOGIN
       * @returns A promise that resolves to the authentication result.
       */
      async function authLogin(): Promise<string> {
        const dialogUrl = "https://your-addin-domain.com/auth-dialog.html";

        return new Promise((resolve, reject) => {
          OfficeRuntime.displayWebDialog(dialogUrl, {
            height: "50%",
            width: "40%",

            onMessage: (message: string, dialog?: OfficeRuntime.Dialog) => {
              // Handle messages sent from the dialog via window.opener.postMessage().
              const data = JSON.parse(message);

              if (data.type === "auth-success") {
                // Process the authentication token
                dialog?.close();
                resolve(`Signed in as ${data.username}`);
              } else if (data.type === "auth-error") {
                dialog?.close();
                reject(new Error(data.errorMessage));
              }
            },

            onClose: () => {
              // Handle the user closing the dialog.
              resolve("Dialog closed");
            },

            onRuntimeError: (error: Error, dialog?: OfficeRuntime.Dialog) => {
              // Handle runtime errors from the dialog.
              dialog?.close();
              reject(error);
            },
          }).catch((error) => {
            reject(new Error(`Failed to open dialog: ${error.message}`));
          });
        });
      }
      ```
    example: []
    isPreview: false
    isDeprecated: false
    syntax:
      content: 'export function displayWebDialog(url: string, options?: DisplayWebDialogOptions): Promise<Dialog>;'
      parameters:
        - id: url
          description: Must be a string.
          type: string
        - id: options
          description: Optional parameter. Must be of type DisplayWebDialogOptions.
          type: <xref uid="office-runtime!OfficeRuntime.DisplayWebDialogOptions:interface" />
      return:
        type: Promise&lt;<xref uid="office-runtime!OfficeRuntime.Dialog:interface" />&gt;
        description: ''
